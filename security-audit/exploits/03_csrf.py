# Exploit CSRF
# Auditor: DAVID H. CUEVAS SALGADO
# Vulnerabilidad: Cross-Site Request Forgery
# Severidad: MEDIA (CVSS 6.5)

import requests
from http.server import HTTPServer, SimpleHTTPRequestHandler
import threading
import webbrowser
import time

print("="*60)
print("EXPLOIT: Cross-Site Request Forgery (CSRF)")
print("="*60)

print("\n[+] Demostración de ataque CSRF:")
print("    1. Usuario tiene sesión activa en http://localhost:5000")
print("    2. Usuario visita página maliciosa (csrf_attack.html)")
print("    3. Formulario malicioso envía petición POST sin consentimiento")
print("    4. Comentario inyectado exitosamente")

print("\n[!] PASOS MANUALES:")
print("    1. Abre http://localhost:5000/login")
print("    2. Haz login como admin/password")
print("    3. Abre security-audit/exploits/csrf_attack.html")
print("    4. Haz clic en 'Reclamar iPhone'")
print("    5. Verifica el comentario malicioso en el dashboard")

print("\n" + "="*60)
print("[!] VULNERABILIDAD: Ausencia de tokens CSRF")
print("[!] IMPACTO: Acciones no autorizadas en nombre del usuario")
print("="*60)
